<html>
    <head>
        <script type="text/javascript" charset="utf-8">  
            (function (g, e, n, es, ys) {  
                  g['_genesysJs'] = e;    g[e] = g[e] || function () { 
                           (g[e].q = g[e].q || []).push(arguments)   
                         };    g[e].t = 1 * new Date(); 
                            g[e].c = es;
                                ys = document.createElement('script'); ys.async = 1; ys.src = n; ys.charset = 'utf-8';
                                 document.head.appendChild(ys);  })
                                 (window, 'Genesys', 'https://apps.inindca.com/genesys-bootstrap/genesys.min.js',
                                  {    environment: 'dev',    deploymentId: 'c81cd282-4969-4c8f-acee-dfa0777a5ca0'
                                  });
            </script>
            <script>
                var webSocket;
                const readyStates = {
                    0: 'CONNECTING',
                    1: 'OPEN',
                    2: 'CLOSING',
                    3: 'CLOSED'
                };

                function establishWebsocketConnection() {
                    if(!webSocket) {
                        var webMessagingUrl = 'wss://webmessaging.inindca.com/v1?deploymentId=c81cd282-4969-4c8f-acee-dfa0777a5ca0'
                        webSocket = new WebSocket(webMessagingUrl);
                        console.log('### WebSocket readystate: ', readyStates[webSocket.readyState]);

                        if(readyStates[webSocket.readyState] === 'CONNECTING') {
                            console.log('### Websocket is connecting', );
                            waitForReadyStateOpen(webSocket, registerWebSocketListeners);
                        }
                    }
                }

                function waitForReadyStateOpen(webSocket, callback) {
                    var pollInterval = setInterval(function(webSocket){
                        console.log('### ReadyState is; ', readyStates[webSocket.readyState]);
                        if(readyStates[webSocket.readyState] === 'OPEN') {
                            if(callback) {
                                callback();
                            }
                            clearInterval(pollInterval);
                        }
                    }, 10000);

                    pollInterval();
                }

                function registerWebSocketListeners() {
                    console.log('### ready for listeners');
                }

                establishWebsocketConnection();
            </script>
    </head>
    <body>

    </body>
</html>